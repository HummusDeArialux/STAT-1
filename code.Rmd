---
title: "PAC 1 Regresión Lineal"
author: "Maria Lucas"
date: "2023-04-22"
output: pdf_document
---
\newpage

# Ejercicio 1

Primero, cargamos los datos del documento excel.
```{r}
#install.packages("readxl")
library("readxl")
data1 = read_excel("cicindela.xlsx")
names(data1)[1] <- "BD"
names(data1)[2] <- "WE"
names(data1)[3] <- "SPS"
names(data1)[4] <- "BS"
names(data1)[5] <- "AD"

```

### (a) Ajuste del modelo

LA IA ME DICE QUE CHECKEE LAS ASUNCIONES (lineal, independencia, homocedasticidad, N de residuos)

```{r}
# Creación del modelo
lmod = lm(BD ~ WE + SPS + BS + AD, data = data1)
sum = summary(lmod)
sum
```

Como podemos observar mediante la estimación de los coeficientes de regresión, la ecuación quedaría como: BD = 14.95 + 0.91WE + 3.89SPS + 0.65BS - 1.56AD.

El modelo obtenido es significativo, con un pvalor global = 6.727e-05. El test estadístico empleado es un F-test, éste testa como H0 que todos los coeficientes de regresión son 0, y como H1 que al menos uno es distinto de 0. 

  - H0: $\beta1 = \beta2 =$...$=\beta$p = 0 (donde $\beta1$, $\beta2$, ..., $\beta$p son los coeficientes de regresión de las variables predictoras del modelo)
  - H1: al menos un $\beta$i es diferente a 0, donde i = 1, 2, ..., p

En este caso al menos una de las variables tiene dependencia lineal con la variable respuesta (Beetle Density), ya que el pvalor es menor a 0.05 y por lo tanto, rechazamos la H0. 

Tal y como se ve en la tabla de coeficientes, tanto SPS (Sand Particle Size, pvalor = 0.01) como AD (Amphipod Density, pvalor = 0.05) tienen un impacto significativo sobre la variable respuesta.

### (b) Intervalos de confianza para AmphipodDensity

```{r}
# CI a 95%
confint(lmod, "AD", level = 0.95)
# CI a 90%
confint(lmod, "AD", level = 0.9)
```

En ninguno de los dos intervalos se incluye el 0, es por ello que podemos deducir que el pvalor sea significativo a un nivel de confianza de 0.1 y 0.05, ya que como hemos explicado medimos si el parámetro es distinto a 0. 

El coeficiente de regresión representa el cambio de la variable respuesta (BD o Beetle Density) por cada unidad que aumenta la variable predictora AD. Si este valor es 0 significa que la variable respuesta no varia conforme cambia el valor de la variable predictora. Si el valor es positivo un incremento de AD supone un incremento de BD, y si el valor es negativo un incremento de AD supone una reducción de BD.

### (c) Multicolinealidad

```{r}
library(car)
vif(lmod)
```

El factor de inflación de la varianza o VIF mide cuánto se incrementa la varianza de los coeficientes de regresión estimados a causa de la colinealidad entre las variables predictoras. Valores mayores a 1 indican ligera correlación, que aumenta conforme aumenta el valor VIF. Valores mayores a  